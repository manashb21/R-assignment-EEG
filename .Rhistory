#creating X testing model
testing_ones = matrix(1, length(XY_testing_set[,"X1"]), 1)
#selecting X_test_set variables needed as per model 2
X_testing_model = cbind(testing_ones,XY_testing_set[,"X4"],(XY_testing_set[,"X1"])^3,(XY_testing_set[ ,"X3"])^4)
#computing model output on testing data model
Y_testing_hat = X_testing_model%*% training_thetahat
Y_testing_hat
RSS_testing=sum((XY_testing_set[,"Y"]-Y_testing_hat)^2)
RSS_testing
#calculating 95% confidence intervals
##qnorm for normal dist, 0.975 as two sided,
sample_sd <- sd(XY_testing_set)
sapply(XY_testing_set, sd)
sapply(XY_testing_df,sd)
sample_sd
#sapply only applicable with dfs
sapply(XY_testing_df[c("X1","X3","X4")],sd)
length(X)
nrow(X)
length(X)/4
#TASK 2
ones = matrix(1 , nrow(X), 1)
ones
length(Y)
sd(Y_testing_hat)
sd(XY_testing_set[,"Y"])
sample_size <- nrow(XY_testing_set[,"Y"])
sample_mean <- mean(XY_testing_set[,"Y"])
nrow(XY_testing_set[,"Y"])
nrow(XY_testing_st)
nrow(XY_testing_set)
sample_size <- nrow(XY_testing_set)
sample_mean <- mean(XY_testing_set[,"Y"])
##qnorm for normal dist, 0.975 as two sided,
z <- qnorm(0.975) #as two sided
# ci = sample mean (+/-) z value * (s.d./ root of sample size)
# ci = sample mean (+/-) t(n-1) value * (s.d./ root of sample size)
c_i_pos <- sample_mean + z * (sample_sd/sqrt(sample_size))
c_i_neg <- sample_mean - z * (sample_sd/sqrt(sample_size))
ggplot(XY_testing_set[,"Y"], aes(x, XY_testing_set[,"Y"]))+
geom_point()+
geom_errorbar(aes(ymin = XY_testing_df[,"Y"] + c_i_neg, ymax = XY_testing_df[,"Y"] + c_i_pos))
ggplot(XY_testing_df[,"Y"], aes(x, XY_testing_set[,"Y"]))+
geom_point()+
geom_errorbar(aes(ymin = XY_testing_df[,"Y"] + c_i_neg, ymax = XY_testing_df[,"Y"] + c_i_pos))
#table with confidence intervals calculated
XY_df <- cbind(XY_testing_df[,"Y"], XY_testing_df + c_i_neg, XY_testing_df + c_i_pos, Y_testing_hat)
XY_ddf
XY_df
head(XY_df)
#table with confidence intervals calculated
XY_df <- cbind(XY_testing_df[,"Y"], XY_testing_df[,"Y"] + c_i_neg, XY_testing_df[,"Y"] + c_i_pos, Y_testing_hat)
head(XY_df)
-0.09352727+c_i_neg
colnames(XY_df) <- c("Y","lower","upper","Yhat")
head(XY_df)
ggplot(XY_df, aes(x, XY_df))+
geom_point()+
geom_errorbar(aes(ymin = lower, ymax=upper))
typeof(XY_df)
#table with confidence intervals calculated
XY_df <- as.data.frame.matrix(cbind(XY_testing_df[,"Y"], XY_testing_df[,"Y"] + c_i_neg, XY_testing_df[,"Y"] + c_i_pos, Y_testing_hat))
typeof(XY_df)
colnames(XY_df) <- c("Y","lower","upper","Yhat")
head(XY_df)
ggplot(XY_df, aes(x, XY_df))+
geom_point()+
geom_errorbar(aes(ymin = lower, ymax=upper))
ggplot(XY_df, aes(x=Y, XY_df))+
geom_point()+
geom_errorbar(aes(ymin = lower, ymax=upper))
ggplot(XY_df, aes(x=Y, y=Yhat))+
geom_point()+
geom_errorbar(aes(ymin = lower, ymax=upper))
ggplot(XY_df, aes(x=row.names(XY_df), y=Yhat))+
geom_point()+
geom_errorbar(aes(ymin = lower, ymax=upper))
ggplot(XY_df, aes(x=row.names(XY_df), y=Yhat))+
#geom_point()+
geom_errorbar(aes(ymin = lower, ymax=upper))
ggplot(XY_df, aes(x=row.names(XY_df), y=Y))+
geom_point()+
geom_errorbar(aes(ymin = lower, ymax=upper))
ggplot(XY_df, aes(x=row.names(XY_df), y=Y))+
geom_point()+
geom_point(aes(x=row.names(XY_df), y=Yhat))+
geom_errorbar(aes(ymin = lower, ymax=upper))
ggplot(XY_df, aes(x=row.names(XY_df), y=Y))+
geom_point()+
geom_point(aes(x=row.names(XY_df), y=Yhat), colour = "red")+
geom_errorbar(aes(ymin = lower, ymax=upper))
#table with confidence intervals calculated of Y-testing-hat
XY_df <- as.data.frame.matrix(cbind(XY_testing_df[,"Y"],  Y_testing_hat, Y_testing_hat + c_i_neg, Y_testing_hat + c_i_pos))
colnames(XY_df) <- c("Y","Yhat","lower","upper")
head(XY_df)
sample_sd <- sd(XY_df[,"Yhat"])
sample_size <- nrow(XY_df)
sample_mean <- mean(XY_df[,"Yhat"])
##qnorm for normal dist, 0.975 as two sided,
z <- qnorm(0.975)         #as two sided
# ci = sample mean (+/-) z value * (s.d./ root of sample size)
c_i_pos <- sample_mean + z * (sample_sd/sqrt(sample_size))
c_i_neg <- sample_mean - z * (sample_sd/sqrt(sample_size))
ggplot(XY_df, aes(x=row.names(XY_df), y=Y))+
geom_point()+
geom_point(aes(x=row.names(XY_df), y=Yhat), colour = "red")+
geom_errorbar(aes(ymin = lower, ymax=upper))
ggplot(XY_df, aes(x=row.names(XY_df), y=Yhat))+
geom_point(colour="blue")+
geom_point(aes(x=row.names(XY_df), y=Y), colour = "red")+
geom_errorbar(aes(ymin = lower, ymax=upper))
ggplot(XY_df, aes(x=row.names(XY_df), y=Yhat))+
geom_point(colour="green")+
geom_point(aes(x=row.names(XY_df), y=Y), colour = "red")+
geom_errorbar(aes(ymin = lower, ymax=upper))
ggplot(XY_df, aes(x=row.names(XY_df), y=Yhat))+
geom_point(colour="orange")+
geom_point(aes(x=row.names(XY_df), y=Y), colour = "red")+
geom_errorbar(aes(ymin = lower, ymax=upper))
ggplot(XY_df, aes(x=row.names(XY_df), y=Yhat))+
geom_point(colour="#B4EEB4")+
geom_point(aes(x=row.names(XY_df), y=Y), colour = "#9932CC")+
geom_errorbar(aes(ymin = lower, ymax=upper))
ggplot(XY_df, aes(x=row.names(XY_df), y=Yhat))+
geom_point(colour="#B4EEB4")+
geom_point(aes(x=row.names(XY_df), y=Y), colour = "#9932CC")+
geom_errorbar(aes(ymin = lower, ymax=upper))
ggplot(XY_df, aes(x=row.names(XY_df), y=Yhat))+
geom_point(colour="#2F4F4F")+
geom_point(aes(x=row.names(XY_df), y=Y), colour = "#9932CC")+
geom_errorbar(aes(ymin = lower, ymax=upper))
ggplot(XY_df, aes(x=row.names(XY_df), y=Yhat))+
geom_point(colour="#FF1493")+
geom_point(aes(x=row.names(XY_df), y=Y), colour = "#9932CC")+
geom_errorbar(aes(ymin = lower, ymax=upper))
ggplot(XY_df, aes(x=row.names(XY_df), y=Yhat))+
geom_point(colour="#B22222")+
geom_point(aes(x=row.names(XY_df), y=Y), colour = "#9932CC")+
geom_errorbar(aes(ymin = lower, ymax=upper))
ggplot(XY_df, aes(x=row.names(XY_df), y=Yhat))+
geom_point(colour="#808000")+
geom_point(aes(x=row.names(XY_df), y=Y), colour = "#9932CC")+
geom_errorbar(aes(ymin = lower, ymax=upper))
ggplot(XY_df, aes(x=row.names(XY_df), y=Yhat))+
geom_point(aes(colour="#808000", size = 2))+
geom_point(aes(x=row.names(XY_df), y=Y), colour = "#9932CC")+
geom_errorbar(aes(ymin = lower, ymax=upper))
ggplot(XY_df, aes(x=row.names(XY_df), y=Yhat))+
geom_point(colour="#808000", size = 2)+
geom_point(aes(x=row.names(XY_df), y=Y), colour = "#9932CC")+
geom_errorbar(aes(ymin = lower, ymax=upper))
ggplot(XY_df, aes(x=row.names(XY_df), y=Yhat))+
geom_point(colour="#e6194B", size = 2)+
geom_point(aes(x=row.names(XY_df), y=Y), colour = "#3cb44b")+
geom_errorbar(aes(ymin = lower, ymax=upper))
ggplot(XY_df, aes(x=row.names(XY_df), y=Yhat))+
geom_point(colour="#e6194B")+
geom_point(aes(x=row.names(XY_df), y=Y), colour = "#3cb44b")+
geom_errorbar(aes(ymin = lower, ymax=upper))
ggplot(XY_df, aes(x=row.names(XY_df), y=Yhat))+
geom_point(colour="#e6194B")+
geom_point(aes(x=row.names(XY_df), y=Y), colour = "#B3EE3A")+
geom_errorbar(aes(ymin = lower, ymax=upper))
ggplot(XY_df, aes(x=row.names(XY_df), y=Yhat))+
geom_point(colour="#e6194B")+
geom_point(aes(x=row.names(XY_df), y=Y), colour = "#EEEE00")+
geom_errorbar(aes(ymin = lower, ymax=upper))
ggplot(XY_df, aes(x=row.names(XY_df), y=Yhat))+
geom_point(colour="#e6194B")+
geom_point(aes(x=row.names(XY_df), y=Y), colour = "#473C8B")+
geom_errorbar(aes(ymin = lower, ymax=upper))
ggplot(XY_df, aes(x=row.names(XY_df), y=Yhat))+
geom_point(colour="#e6194B")+
geom_point(aes(x=row.names(XY_df), y=Y), colour = "#473C8B", size = 1)+
geom_errorbar(aes(ymin = lower, ymax=upper))
ggplot(XY_df, aes(x=row.names(XY_df), y=Yhat))+
geom_point(colour="#e6194B", size = 1)+
geom_point(aes(x=row.names(XY_df), y=Y), colour = "#473C8B", size = 1)+
geom_errorbar(aes(ymin = lower, ymax=upper))
ggplot(XY_df, aes(x=row.names(XY_df), y=Yhat))+
geom_point(colour="#e6194B", size = 2)+
geom_point(aes(x=row.names(XY_df), y=Y), colour = "#473C8B", size = 2)+
geom_errorbar(aes(ymin = lower, ymax=upper))
ggplot(XY_df, aes(x=row.names(XY_df), y=Yhat))+
geom_point(aes(color=Yhat))+
geom_point(aes(x=row.names(XY_df), y=Y, colour = Y))+
geom_errorbar(aes(ymin = lower, ymax=upper))+
scale_colour_manual(NULL, values = c(Yhat = "red", y = "blue"))
ggplot(XY_df, aes(x=row.names(XY_df), y=Yhat))+
geom_point(aes(color=Yhat))+
geom_point(aes(x=row.names(XY_df), y=Y, colour = Y))+
geom_errorbar(aes(ymin = lower, ymax=upper))+
scale_colour_manual(values = c(Yhat = "red", y = "blue"))
ggplot(XY_df, aes(x=row.names(XY_df)))+
geom_point(aes(color=Yhat))+
geom_point(aes(x=row.names(XY_df), y=Y, colour = Y))+
geom_errorbar(aes(ymin = lower, ymax=upper))+
scale_colour_manual(values = c(Yhat = "red", y = "blue"))
ggplot(XY_df, aes(x=row.names(XY_df)))+
geom_point(aes(color=Yhat, y = Yhat))+
geom_point(aes(x=row.names(XY_df), y=Y, colour = Y))+
geom_errorbar(aes(ymin = lower, ymax=upper))+
scale_colour_manual(values = c(Yhat = "red", y = "blue"))
ggplot(XY_df, aes(x=row.names(XY_df)))+
geom_point(aes(color=Yhat, y = Yhat))+
geom_point(aes(x=row.names(XY_df), y=Y, colour = Y))+
geom_errorbar(aes(ymin = lower, ymax=upper))+
scale_colour_manual(values = c("red", "blue"))
ggplot(XY_df, aes(x=row.names(XY_df), colour = factor(Yhat)))+
geom_point(aes(color=Yhat, y = Yhat))+
geom_point(aes(x=row.names(XY_df), y=Y, colour = Y))+
geom_errorbar(aes(ymin = lower, ymax=upper))+
scale_colour_manual(values = c("red", "blue"))
ggplot(XY_df, aes(x=row.names(XY_df)))+
geom_point(aes(color=Yhat, y = Yhat))+
geom_point(aes(x=row.names(XY_df), y=Y, colour = Y))+
geom_errorbar(aes(ymin = lower, ymax=upper))
ggplot(XY_df, aes(x=row.names(XY_df)))+
geom_point(aes(y = Yhat))+
geom_point(aes(x=row.names(XY_df), y=Y, colour = Y))+
geom_errorbar(aes(ymin = lower, ymax=upper))
geom_point(aes(x=row.names(XY_df), y=Y)+
ggplot(XY_df, aes(x=row.names(XY_df)))+
geom_point(aes(y = Yhat))+
geom_point(aes(x=row.names(XY_df), y=Y))+
geom_errorbar(aes(ymin = lower, ymax=upper))
exit
ggplot(XY_df, aes(x=row.names(XY_df)))+
geom_point(aes(y = Yhat))+
geom_point(aes(x=row.names(XY_df), y=Y))+
geom_errorbar(aes(ymin = lower, ymax=upper))
ggplot(XY_df, aes(x=row.names(XY_df)))+
geom_point(aes(y = Yhat))+
geom_point(aes(x=row.names(XY_df), y=Y), colour = "#E7B800")+
geom_errorbar(aes(ymin = lower, ymax=upper))
ggplot(XY_df, aes(x=row.names(XY_df)))+
geom_point(aes(y = Yhat))+
geom_point(aes(x=row.names(XY_df), y=Y), colour = "#E7B800")+
geom_errorbar(aes(ymin = lower, ymax=upper))+
theme(axis.text.x = element_text(angle = 90))
#scatter plot between X1 and Y
par(mfrow = c(2,2))
plot(X[,"X1"], Y, main = "Scatter Plot: X1 and Y signal", xlab = "X1 signal",
ylab = "Output Signal")
abline(lm(X[,'X1'] ~ Y), col = 'red')
#scatter plot between X2 and Y
plot(X[,"X2"], Y, main = "Scatter Plot: X2 and Y signal", xlab = "X2 signal",
ylab = "Output Signal")
abline(lm(X[,'X2'] ~ Y), col = 'red')
#scatter plot between X3 and Y
plot(X[,"X3"], Y, main = "Scatter Plot: X3 and Y signal", xlab = "X3 signal",
ylab = "Output Signal")
abline(lm(X[,'X3'] ~ Y), col = 'red')
#scatter plot between X4 and Y
plot(X[,"X4"], Y, main = "Scatter Plot: X4 and Y signal", xlab = "X4 signal",
ylab = "Output Signal")
abline(lm(X[,'X4'] ~ Y), col = 'red')
#using ggplot
XY_table <- cbind(X,Y)
head(XY_table)
head(X)
typeof(XY_table)
ggplot(XY_table, aes(x = X1, y=Y))+
geom_point()+
geom_smooth(method = lm, se= FALSE)
#using ggplot
XY_table <- as.data.table(cbind(X,Y))
#using ggplot
XY_table <- as.data.frame(cbind(X,Y))
head(XY_table)
typeof(XY_table)
ggplot(XY_table, aes(x = X1, y=Y))+
geom_point()+
geom_smooth(method = lm, se= FALSE)
ggplot(XY_table, aes(x = X1, y=Y))+
geom_point()+
geom_smooth(method = lm, se= FALSE)+
ggtitle("Correlation and Scatter Plot of X1 and Y")
ggplot(XY_table, aes(x = X1, y=Y))+
geom_point()+
geom_smooth(method = lm, se= FALSE)+
ggtitle("Correlation and Scatter Plot of X1 and Y")
ggplot(XY_table, aes(x = X1, y=Y))+
geom_point()+
geom_smooth(method = lm, se= FALSE, colour = "red")+
ggtitle("Correlation and Scatter Plot of X1 and Y")
par(mfrow = c(2,2))
ggplot(XY_table, aes(x = X1, y=Y))+
geom_point()+
geom_smooth(method = lm, se= FALSE, colour = "red")+
ggtitle("Correlation and Scatter Plot of X1 and Y")
ggplot(XY_table, aes(x = X2, y=Y))+
geom_point()+
geom_smooth(method = lm, se= FALSE, colour = "red")+
ggtitle("Correlation and Scatter Plot of X2 and Y")
ggplot(XY_table, aes(x = X3, y=Y))+
geom_point()+
geom_smooth(method = lm, se= FALSE, colour = "red")+
ggtitle("Correlation and Scatter Plot of X3 and Y")
ggplot(XY_table, aes(x = X4, y=Y))+
geom_point()+
geom_smooth(method = lm, se= FALSE, colour = "red")+
ggtitle("Correlation and Scatter Plot of X4 and Y")
par(mfrow = c(2,2))
plot(X[,"X1"], Y, main = "Scatter Plot: X1 and Y signal", xlab = "X1 signal",
ylab = "Output Signal")
abline(lm(X[,'X1'] ~ Y), col = 'red')
#scatter plot between X2 and Y
plot(X[,"X2"], Y, main = "Scatter Plot: X2 and Y signal", xlab = "X2 signal",
ylab = "Output Signal")
abline(lm(X[,'X2'] ~ Y), col = 'red')
#scatter plot between X3 and Y
plot(X[,"X3"], Y, main = "Scatter Plot: X3 and Y signal", xlab = "X3 signal",
ylab = "Output Signal")
abline(lm(X[,'X3'] ~ Y), col = 'red')
#scatter plot between X4 and Y
plot(X[,"X4"], Y, main = "Scatter Plot: X4 and Y signal", xlab = "X4 signal",
ylab = "Output Signal")
abline(lm(X[,'X4'] ~ Y), col = 'red')
ggplot(XY_table, aes(x = X1, y=Y))+
geom_point()+
geom_smooth(method = lm, se= FALSE, colour = "red")+
ggtitle("Correlation and Scatter Plot of X1 and Y")
ggplot(XY_table, aes(x = X2, y=Y))+
geom_point()+
geom_smooth(method = lm, se= FALSE, colour = "red")+
ggtitle("Correlation and Scatter Plot of X2 and Y")
ggplot(XY_table, aes(x = X3, y=Y))+
geom_point()+
geom_smooth(method = lm, se= FALSE, colour = "red")+
ggtitle("Correlation and Scatter Plot of X3 and Y")
ggplot(XY_table, aes(x = X4, y=Y))+
geom_point()+
geom_smooth(method = lm, se= FALSE, colour = "red")+
ggtitle("Correlation and Scatter Plot of X4 and Y")
#TASK 2
ones = matrix(1 , nrow(X), 1)
ones
#2.1
#estimating model parameters using Least squares theta-hat
# thetahat <- Inverse(Xtr %*% X) %*% Xtr %*% Y
Xmodel1 <- cbind(ones,(X[,'X4']),(X[,'X1'])^2,(X[,'X1'])^3,(X[,'X2'])^4,(X[,'X1'])^4)
model1_thetahat = solve(t(Xmodel1)%*%Xmodel1)%*%t(Xmodel1)%*%Y
Xmodel2 <- cbind(ones,(X[,'X4']),(X[,'X1'])^3,(X[,'X3'])^4)
model2_thetahat = solve(t(Xmodel2)%*%Xmodel2)%*%t(Xmodel2)%*%Y
Xmodel3 <- cbind(ones,(X[,'X3'])^3,(X[,'X3'])^4)
model3_thetahat = solve(t(Xmodel3)%*%Xmodel3)%*%t(Xmodel3)%*%Y
Xmodel4 <- cbind(ones,(X[,'X2']),(X[,'X1'])^3,(X[,'X3'])^4)
model4_thetahat = solve(t(Xmodel4)%*%Xmodel4)%*%t(Xmodel4)%*%Y
Xmodel5 <- cbind(ones,(X[,'X4']),(X[,'X1'])^2,(X[,'X1'])^3,(X[,'X3'])^4)
model5_thetahat = solve(t(Xmodel5)%*%Xmodel5)%*%t(Xmodel5)%*%Y
model1_thetahat
write.csv(model1_thetahat, "results/model1thetahat.csv")
write.csv(model1_thetahat, "results/model1thetahat.csv")
as.data.frame(model1_thetahat)
Xmodel2 <- cbind(ones,(X[,'X4']),(X[,'X1'])^3,(X[,'X3'])^4)
model2_thetahat = solve(t(Xmodel2)%*%Xmodel2)%*%t(Xmodel2)%*%Y
write.csv(model2_thetahat, "results/model2thetahat.csv")
Xmodel3 <- cbind(ones,(X[,'X3'])^3,(X[,'X3'])^4)
model3_thetahat = solve(t(Xmodel3)%*%Xmodel3)%*%t(Xmodel3)%*%Y
write.csv(model3_thetahat, "results/model3thetahat.csv")
Xmodel4 <- cbind(ones,(X[,'X2']),(X[,'X1'])^3,(X[,'X3'])^4)
model4_thetahat = solve(t(Xmodel4)%*%Xmodel4)%*%t(Xmodel4)%*%Y
write.csv(model4_thetahat, "results/model4thetahat.csv")
Xmodel5 <- cbind(ones,(X[,'X4']),(X[,'X1'])^2,(X[,'X1'])^3,(X[,'X3'])^4)
model5_thetahat = solve(t(Xmodel5)%*%Xmodel5)%*%t(Xmodel5)%*%Y
write.csv(model5_thetahat, "results/model5thetahat.csv")
Y_hat_m1 = Xmodel1 %*% model1_thetahat
Y_hat_m1
RSS_Model_1=sum((Y-Y_hat_m1)^2)
RSS_Model_1
Y_hat_m2 = Xmodel2 %*% model2_thetahat
Y_hat_m2
RSS_Model_2=sum((Y-Y_hat_m2)^2)
RSS_Model_2
Y_hat_m3 = Xmodel3 %*% model3_thetahat
Y_hat_m3
RSS_Model_3=sum((Y-Y_hat_m3)^2)
RSS_Model_3
Y_hat_m4 = Xmodel4 %*% model4_thetahat
Y_hat_m4
RSS_Model_4=sum((Y-Y_hat_m4)^2)
RSS_Model_4
Y_hat_m5 = Xmodel5 %*% model5_thetahat
Y_hat_m5
RSS_Model_5=sum((Y-Y_hat_m5)^2)
RSS_Model_5
Y_hat_m1
tail(Y_hat_m1)
tail(Y)
ggplot(XY_df, aes(x=row.names(XY_df)))+
geom_point(aes(y = Yhat))+
geom_line(mean(Y))+
#geom_point(aes(x=row.names(XY_df), y=Y), colour = "#E7B800")+
geom_errorbar(aes(ymin = lower, ymax=upper))+
theme(axis.text.x = element_text(angle = 90))
geom_line(aes(y=mean(Y))+
ggplot(XY_df, aes(x=row.names(XY_df)))+
geom_point(aes(y = Yhat))+
geom_line(aes(y=mean(Y)))+
#geom_point(aes(x=row.names(XY_df), y=Y), colour = "#E7B800")+
geom_errorbar(aes(ymin = lower, ymax=upper))+
theme(axis.text.x = element_text(angle = 90))
ggplot(XY_df, aes(x=row.names(XY_df)))+
ggplot(XY_df, aes(x=row.names(XY_df)))+
geom_point(aes(y = Yhat))+
geom_line(aes(y=mean(Y)))+
#geom_point(aes(x=row.names(XY_df), y=Y), colour = "#E7B800")+
geom_errorbar(aes(ymin = lower, ymax=upper))+
theme(axis.text.x = element_text(angle = 90))
ggplot(XY_df, aes(x=row.names(XY_df)))+
geom_point(aes(y = Yhat))+
geom_hline(yintercept = mean(Y))+
#geom_point(aes(x=row.names(XY_df), y=Y), colour = "#E7B800")+
geom_errorbar(aes(ymin = lower, ymax=upper))+
theme(axis.text.x = element_text(angle = 90))
#using the t-distribution
t <- 2.262       # for n-1
c_i_pos_t <- sample_mean + t * (sample_sd/sqrt(sample_size))
c_i_neg_t <- sample_mean - t * (sample_sd/sqrt(sample_size))
XY_df_1 <- as.data.frame.matrix(cbind(XY_testing_df[,"Y"],  Y_testing_hat, Y_testing_hat + c_i_neg_t, Y_testing_hat + c_i_pos_t))
colnames(XY_df) <- c("Y","Yhat","lower","upper")
ggplot(XY_df_1, aes(x=row.names(XY_df_1)))+
geom_point(aes(y = Yhat))+
geom_hline(yintercept = mean(Y))+
#geom_point(aes(x=row.names(XY_df), y=Y), colour = "#E7B800")+
geom_errorbar(aes(ymin = lower, ymax=upper))+
theme(axis.text.x = element_text(angle = 90))
#using the t-distribution
t <- 2.262       # for n-1
c_i_pos_t <- sample_mean + t * (sample_sd/sqrt(sample_size))
c_i_neg_t <- sample_mean - t * (sample_sd/sqrt(sample_size))
XY_df_1 <- as.data.frame.matrix(cbind(XY_testing_df[,"Y"],  Y_testing_hat, Y_testing_hat + c_i_neg_t, Y_testing_hat + c_i_pos_t))
colnames(XY_df_1) <- c("Y","Yhat","lower","upper")
ggplot(XY_df_1, aes(x=row.names(XY_df_1)))+
geom_point(aes(y = Yhat))+
geom_hline(yintercept = mean(Y))+
#geom_point(aes(x=row.names(XY_df), y=Y), colour = "#E7B800")+
geom_errorbar(aes(ymin = lower, ymax=upper))+
theme(axis.text.x = element_text(angle = 90))
t <- 2.262       # for n-1
c_i_pos_t <- sample_mean + t * (sample_sd/sqrt(sample_size))
c_i_neg_t <- sample_mean - t * (sample_sd/sqrt(sample_size))
XY_df_1 <- as.data.frame.matrix(cbind(XY_testing_df[,"Y"],  Y_testing_hat, Y_testing_hat - c_i_neg_t, Y_testing_hat + c_i_pos_t))
colnames(XY_df_1) <- c("Y","Yhat","lower","upper")
ggplot(XY_df_1, aes(x=row.names(XY_df_1)))+
geom_point(aes(y = Yhat))+
geom_hline(yintercept = mean(Y))+
#geom_point(aes(x=row.names(XY_df), y=Y), colour = "#E7B800")+
geom_errorbar(aes(ymin = lower, ymax=upper))+
theme(axis.text.x = element_text(angle = 90))
XY_df_1 <- as.data.frame.matrix(cbind(XY_testing_df[,"Y"],  Y_testing_hat, Y_testing_hat + c_i_neg_t, Y_testing_hat + c_i_pos_t))
t <- 2.262       # for n-1
c_i_pos_t <- sample_mean + t * (sample_sd/sqrt(sample_size))
c_i_neg_t <- sample_mean - t * (sample_sd/sqrt(sample_size))
XY_df_1 <- as.data.frame.matrix(cbind(XY_testing_df[,"Y"],  Y_testing_hat, Y_testing_hat + c_i_neg_t, Y_testing_hat + c_i_pos_t))
colnames(XY_df_1) <- c("Y","Yhat","lower","upper")
ggplot(XY_df_1, aes(x=row.names(XY_df_1)))+
geom_point(aes(y = Yhat))+
geom_hline(yintercept = mean(Y))+
#geom_point(aes(x=row.names(XY_df), y=Y), colour = "#E7B800")+
geom_errorbar(aes(ymin = lower, ymax=upper))+
theme(axis.text.x = element_text(angle = 90))
t <- 2     # for n-1, 61-1=60 degree of freedom
c_i_pos_t <- sample_mean + t * (sample_sd/sqrt(sample_size))
c_i_neg_t <- sample_mean - t * (sample_sd/sqrt(sample_size))
XY_df_1 <- as.data.frame.matrix(cbind(XY_testing_df[,"Y"],  Y_testing_hat, Y_testing_hat + c_i_neg_t, Y_testing_hat + c_i_pos_t))
colnames(XY_df_1) <- c("Y","Yhat","lower","upper")
ggplot(XY_df_1, aes(x=row.names(XY_df_1)))+
geom_point(aes(y = Yhat))+
geom_hline(yintercept = mean(Y))+
#geom_point(aes(x=row.names(XY_df), y=Y), colour = "#E7B800")+
geom_errorbar(aes(ymin = lower, ymax=upper))+
theme(axis.text.x = element_text(angle = 90))
c_i_pos_t
c_i_neg_t
c_i_pos
c_i_neg
t <- 2     # for n-1, 61-1=60 degree of freedom
c_i_pos_t <- sample_mean + t * (sample_sd/sqrt(sample_size))
c_i_neg_t <- sample_mean - t * (sample_sd/sqrt(sample_size))
XY_df_1 <- as.data.frame.matrix(cbind(XY_testing_df[,"Y"],  Y_testing_hat, c_i_neg_t, c_i_pos_t))
colnames(XY_df_1) <- c("Y","Yhat","lower","upper")
ggplot(XY_df_1, aes(x=row.names(XY_df_1)))+
geom_point(aes(y = Yhat))+
geom_hline(yintercept = mean(Y))+
#geom_point(aes(x=row.names(XY_df), y=Y), colour = "#E7B800")+
geom_errorbar(aes(ymin = lower, ymax=upper))+
theme(axis.text.x = element_text(angle = 90))
#using the t-distribution
t <- 2     # for n-1, 61-1=60 degree of freedom
c_i_pos_t <- sample_mean + t * (sample_sd/sqrt(sample_size))
c_i_neg_t <- sample_mean - t * (sample_sd/sqrt(sample_size))
XY_df_1 <- as.data.frame.matrix(cbind(XY_testing_df[,"Y"],  Y_testing_hat, Y_testing_hat + c_i_neg_t, Y_testing_hat + c_i_pos_t))
colnames(XY_df_1) <- c("Y","Yhat","lower","upper")
ggplot(XY_df_1, aes(x=row.names(XY_df_1)))+
geom_point(aes(y = Yhat))+
geom_hline(yintercept = mean(Y))+
#geom_point(aes(x=row.names(XY_df), y=Y), colour = "#E7B800")+
geom_errorbar(aes(ymin = lower, ymax=upper))+
theme(axis.text.x = element_text(angle = 90))
t <- 2     # for n-1, 61-1=60 degree of freedom
c_i_pos_t <- sample_mean + t * (sample_sd/sqrt(sample_size))
c_i_neg_t <- sample_mean - t * (sample_sd/sqrt(sample_size))
XY_df_1 <- as.data.frame.matrix(cbind(XY_testing_df[,"Y"],  Y_testing_hat, Y_testing_hat + c_i_neg_t, Y_testing_hat + c_i_pos_t))
colnames(XY_df_1) <- c("Y","Yhat","lower","upper")
ggplot(XY_df_1, aes(x=row.names(XY_df_1)))+
geom_point(aes(y = Yhat))+
#geom_hline(yintercept = mean(Y))+
#geom_point(aes(x=row.names(XY_df), y=Y), colour = "#E7B800")+
geom_errorbar(aes(ymin = lower, ymax=upper))+
theme(axis.text.x = element_text(angle = 90))
